(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5433],{474:(e,t,n)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/docs/setup/configure-lifecycle",function(){return n(8920)}])},1513:(e,t,n)=>{"use strict";n.d(t,{R:()=>a});var o=n(1668),s=n(4587),i=n.n(s),l=n(4232);let r={img:e=>(0,l.createElement)("object"==typeof e.src?i():"img",e)},a=e=>(0,o.R)({...r,...e})},1807:(e,t,n)=>{"use strict";n.d(t,{e:()=>c});var o=n(7876),s=n(181),i=n(7096);let l=(0,n(4232).createContext)({}),r=l.Provider;l.displayName="SSG";var a=n(1513);function c(e,t,n,o){let i=globalThis[s.VZ];return i.route=t,i.pageMap=n.pageMap,i.context[t]={Content:e,pageOpts:n,useTOC:o},d}function d({__nextra_pageMap:e=[],__nextra_dynamic_opts:t,...n}){let l=globalThis[s.VZ],{Layout:a,themeConfig:c}=l,{route:d,locale:p}=(0,i.r)(),u=l.context[d];if(!u)throw Error(`No content found for the "${d}" route. Please report it as a bug.`);let{pageOpts:f,useTOC:g,Content:F}=u;if(d.startsWith("/["))f.pageMap=e;else for(let{route:t,children:n}of e){let e=t.split("/").slice(p?2:1);(function e(t,[n,...o]){for(let s of t)if("children"in s&&n===s.name)return o.length?e(s.children,o):s})(f.pageMap,e).children=n}if(t){let{title:e,frontMatter:n}=t;f={...f,title:e,frontMatter:n}}return(0,o.jsx)(a,{themeConfig:c,pageOpts:f,pageProps:n,children:(0,o.jsx)(r,{value:n,children:(0,o.jsx)(h,{useTOC:g,children:(0,o.jsx)(F,{...n})})})})}function h({children:e,useTOC:t}){let{wrapper:n}=(0,a.R)();return(0,o.jsx)(p,{useTOC:t,wrapper:n,children:e})}function p({children:e,useTOC:t,wrapper:n,...s}){let i=t(s);return n?(0,o.jsx)(n,{toc:i,children:e}):e}},8920:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>c,useTOC:()=>a});var o=n(7876),s=n(1807),i=n(4674),l=n(1513),r=n(9941);function a(e){return[{value:"Set Default IP Whitelist",id:"set-default-ip-whitelist",depth:2},{value:"Refresh config cache",id:"refresh-config-cache",depth:2}]}let c=(0,s.e)(function(e){let{toc:t=a(e)}=e,n={code:"code",h2:"h2",hr:"hr",li:"li",p:"p",strong:"strong",ul:"ul",...(0,l.R)(),...e.components},{Code:s}=n;return s||function(e,t){throw Error("Expected "+(t?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Code",!0),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.p,{children:"We are in the final step of the setup process."}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.strong,{children:"This step is Optional but highly recommended to ensure the default IP Whitelist is set for the environments created by the Lifecycle app."})," This will help in securing the environments and restricting access to only the specified IPs or CIDR blocks."]}),"\n",(0,o.jsx)(n.h2,{id:t[0].id,children:t[0].value}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:["Connect to the ",(0,o.jsx)(n.code,{children:"postgres"})," database using the ",(0,o.jsx)(n.code,{children:"psql"})," command line tool or any other database client."]}),"\n",(0,o.jsx)(r.P,{type:"info",children:(0,o.jsxs)(n.p,{children:["Database password was auto generated during the infra setup and can be found\nretrieved from the ",(0,o.jsx)(n.code,{children:"app-postgres"})," secret in the ",(0,o.jsx)(n.code,{children:"lifecycle-app"}),"\nnamespace."]})}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsx)(n.p,{children:"Retrieve the database password:"}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(s,{codeblock:{value:"   kubectl get secret app-postgres --namespace lifecycle-app \\\n      -o jsonpath='{.data}' | jq 'with_entries(.value |= @base64d)'",lang:"shellscript",meta:"",code:"   kubectl get secret app-postgres --namespace lifecycle-app \\\n      -o jsonpath='{.data}' | jq 'with_entries(.value |= @base64d)'",tokens:["   ",["kubectl","#FFA657"]," ",["get secret app-postgres","#A5D6FF"]," ",["--namespace","#79C0FF"]," ",["lifecycle-app","#A5D6FF"]," ",["\\","#79C0FF"],"\n      ",["-o","#79C0FF"]," ",["jsonpath='{.data}'","#A5D6FF"]," ",["|","#FF7B72"]," ",["jq","#FFA657"]," ",["'with_entries(.value |= @base64d)'","#A5D6FF"]],annotations:[],themeName:"github-dark",style:{color:"#c9d1d9",background:"#0d1117",colorScheme:"dark"}}}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Run the following SQL commands to update the configuration:"}),"\n"]}),"\n",(0,o.jsx)(s,{codeblock:{value:'-- provide a default IP whitelist for the environments, default is open to all IPs\nUPDATE public.global_config\nSET\n    config = (\n        config::jsonb ||\n        \'{\n            "defaultIPWhiteList": "{ 0.0.0.0/0 }"\n         }\'::jsonb\n    )::json,\n    "updatedAt" = NOW()\nWHERE "key" = \'serviceDefaults\';',lang:"sql",meta:"",code:'-- provide a default IP whitelist for the environments, default is open to all IPs\nUPDATE public.global_config\nSET\n    config = (\n        config::jsonb ||\n        \'{\n            "defaultIPWhiteList": "{ 0.0.0.0/0 }"\n         }\'::jsonb\n    )::json,\n    "updatedAt" = NOW()\nWHERE "key" = \'serviceDefaults\';',tokens:[["-- provide a default IP whitelist for the environments, default is open to all IPs","#8B949E"],"\n",["UPDATE","#FF7B72"]," ",["public","#79C0FF"],[".","#C9D1D9"],["global_config","#79C0FF"],"\n",["SET","#FF7B72"],"\n    ",["config","#C9D1D9"]," ",["=","#FF7B72"]," ",["(","#C9D1D9"],"\n        ",["config::jsonb","#C9D1D9"]," ",["||","#FF7B72"],"\n        ",["'{","#A5D6FF"],"\n            ",['"defaultIPWhiteList": "{ 0.0.0.0/0 }"',"#A5D6FF"],"\n         ",["}'","#A5D6FF"],["::jsonb","#C9D1D9"],"\n    ",[")::","#C9D1D9"],["json","#FF7B72"],[",","#C9D1D9"],"\n    ",['"updatedAt"',"#A5D6FF"]," ",["= NOW","#FF7B72"],["()","#C9D1D9"],"\n",["WHERE","#FF7B72"]," ",['"key"',"#A5D6FF"]," ",["=","#FF7B72"]," ",["'serviceDefaults'","#A5D6FF"],[";","#C9D1D9"]],annotations:[],themeName:"github-dark",style:{color:"#c9d1d9",background:"#0d1117",colorScheme:"dark"}}}),"\n",(0,o.jsxs)(r.P,{type:"error",emoji:"⚠️",children:[(0,o.jsxs)(n.p,{children:["Note that the infra setup with the OpenTofu modules below will ",(0,o.jsx)(n.strong,{children:"open your\ncluster to the world."})," ",(0,o.jsx)("br",{}),"\n\uD83D\uDEE1️ Make sure to ",(0,o.jsx)(n.strong,{children:(0,o.jsx)("a",{href:"https://translate.google.com/details?sl=auto&tl=hy&text=shield&op=translate",children:"shield"})})," your cluster by implementing appropriate network policies\nand access controls after the initial setup."]}),(0,o.jsxs)(n.p,{children:["Replace the ",(0,o.jsx)(n.code,{children:"defaultIPWhiteList"})," under ",(0,o.jsx)(n.code,{children:"global_config.serviceDefaults"})," with your actual IP whitelist or CIDR block to restrict access to the deployed environments."]})]}),"\n",(0,o.jsx)(n.hr,{}),"\n",(0,o.jsx)(n.h2,{id:t[1].id,children:t[1].value}),"\n",(0,o.jsx)(s,{codeblock:{value:"curl -X PUT https://app.<your_domain>/api/v1/config/cache",lang:"shellscript",meta:"",code:"curl -X PUT https://app.<your_domain>/api/v1/config/cache",tokens:[["curl","#FFA657"]," ",["-X","#79C0FF"]," ",["PUT https://app.","#A5D6FF"],["<","#FF7B72"],["your_domai","#A5D6FF"],["n","#C9D1D9"],[">","#FF7B72"],["/api/v1/config/cache","#A5D6FF"]],annotations:[],themeName:"github-dark",style:{color:"#c9d1d9",background:"#0d1117",colorScheme:"dark"}}}),"\n",(0,o.jsx)(n.p,{children:"This will refresh the configuration cache and apply the changes you made to the database for the Lifecycle app."}),"\n",(0,o.jsx)(n.p,{children:"We are all set! \uD83C\uDF89 And ready to create our first PR based ephemeral environment."})]})},"/docs/setup/configure-lifecycle",{filePath:"src/pages/docs/setup/configure-lifecycle.mdx",timestamp:1749151886e3,pageMap:i.O,frontMatter:{title:"Additional Configuration",tags:["configure","lifecycle","install","setup"]},title:"Additional Configuration"},"undefined"==typeof RemoteContent?a:RemoteContent.useTOC)}},e=>{var t=t=>e(e.s=t);e.O(0,[4674,636,6593,8792],()=>t(474)),_N_E=e.O()}]);