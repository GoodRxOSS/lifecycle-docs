(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4737],{1513:(e,n,i)=>{"use strict";i.d(n,{R:()=>a});var t=i(1668),r=i(4587),l=i.n(r),c=i(4232);let o={img:e=>(0,c.createElement)("object"==typeof e.src?l():"img",e)},a=e=>(0,t.R)({...o,...e})},1807:(e,n,i)=>{"use strict";i.d(n,{e:()=>d});var t=i(7876),r=i(181),l=i(7096);let c=(0,i(4232).createContext)({}),o=c.Provider;c.displayName="SSG";var a=i(1513);function d(e,n,i,t){let l=globalThis[r.VZ];return l.route=n,l.pageMap=i.pageMap,l.context[n]={Content:e,pageOpts:i,useTOC:t},s}function s({__nextra_pageMap:e=[],__nextra_dynamic_opts:n,...i}){let c=globalThis[r.VZ],{Layout:a,themeConfig:d}=c,{route:s,locale:u}=(0,l.r)(),m=c.context[s];if(!m)throw Error(`No content found for the "${s}" route. Please report it as a bug.`);let{pageOpts:p,useTOC:f,Content:v}=m;if(s.startsWith("/["))p.pageMap=e;else for(let{route:n,children:i}of e){let e=n.split("/").slice(u?2:1);(function e(n,[i,...t]){for(let r of n)if("children"in r&&i===r.name)return t.length?e(r.children,t):r})(p.pageMap,e).children=i}if(n){let{title:e,frontMatter:i}=n;p={...p,title:e,frontMatter:i}}return(0,t.jsx)(a,{themeConfig:d,pageOpts:p,pageProps:i,children:(0,t.jsx)(o,{value:i,children:(0,t.jsx)(h,{useTOC:f,children:(0,t.jsx)(v,{...i})})})})}function h({children:e,useTOC:n}){let{wrapper:i}=(0,a.R)();return(0,t.jsx)(u,{useTOC:n,wrapper:i,children:e})}function u({children:e,useTOC:n,wrapper:i,...r}){let l=n(r);return i?(0,t.jsx)(i,{toc:l,children:e}):e}},4414:(e,n,i)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/docs/getting-started/configure-environment",function(){return i(7404)}])},7404:(e,n,i)=>{"use strict";i.r(n),i.d(n,{default:()=>d,useTOC:()=>a});var t=i(7876),r=i(1807),l=i(4674),c=i(1513),o=i(9941);function a(e){return[{value:"Understanding Configuration",id:"understanding-configuration",depth:2},{value:"Default and Optional Services",id:"default-and-optional-services",depth:3},{value:"Template Variables",id:"template-variables",depth:3},{value:"Static Environment as a Fallback",id:"static-environment-as-a-fallback",depth:2},{value:"Check Template Variables",id:"check-template-variables",depth:3},{value:"Configuring Services",id:"configuring-services",depth:2},{value:"Enable Cache Deployment",id:"enable-cache-deployment",depth:3},{value:"Confirm the New Cache URL",id:"confirm-the-new-cache-url",depth:3},{value:"Build Flexible Environments",id:"build-flexible-environments",depth:2},{value:"Summary",id:"summary",depth:2}]}let d=(0,r.e)(function(e){let{toc:n=a(e)}=e,i={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",strong:"strong",ul:"ul",...(0,c.R)(),...e.components},{Code:r}=i;return r||function(e,n){throw Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Code",!0),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.p,{children:"Now that we’ve created and deployed our first Lifecycle environment, let’s learn how to customize it by configuring services and dependencies."}),"\n",(0,t.jsx)(i.h2,{id:n[0].id,children:n[0].value}),"\n",(0,t.jsxs)(i.p,{children:["First, let’s take a look at the ",(0,t.jsx)(i.code,{children:"lifecycle.yaml"})," configuration file at the root dir of ",(0,t.jsx)(i.a,{href:"https://github.com/GoodRxOSS/lifecycle-examples/blob/main/lifecycle.yaml",children:"lifecycle-examples"})," repository:"]}),"\n",(0,t.jsx)(r,{codeblock:{value:'environment:\n  autoDeploy: true\n  defaultServices:\n    - name: "frontend"\n    - name: "backend"\n  optionalServices:\n    - name: "cache"\n\nservices:\n  - name: "frontend"\n    defaultUUID: "dev-0"\n    github:\n      repository: "iceycake/lifecycle-examples"\n      branchName: "main"\n      docker:\n        builder:\n          engine: "buildkit"\n        defaultTag: "main"\n        app:\n          dockerfilePath: "Dockerfile.frontend"\n          ports:\n            - 3000\n          env:\n            COMPONENT: "app"\n            ENV: "lifecycle"\n            API_URL: "https://{{{backend_publicUrl}}}"\n            CACHE_URL: "{{{cache_internalHostname}}}"\n            WES_IS: "GOAT"\n  - name: "backend"\n    requires:\n      - name: "db"\n    defaultUUID: "dev-0"\n    # ...\n  - name: "db"\n    defaultUUID: "dev-0"\n    # ...\n  - name: "cache"\n    defaultUUID: "dev-0"\n    # ...',lang:"yaml",meta:'filename="lifecycle.yaml"',code:'environment:\n  autoDeploy: true\n  defaultServices:\n    - name: "frontend"\n    - name: "backend"\n  optionalServices:\n    - name: "cache"\n\nservices:\n  - name: "frontend"\n    defaultUUID: "dev-0"\n    github:\n      repository: "iceycake/lifecycle-examples"\n      branchName: "main"\n      docker:\n        builder:\n          engine: "buildkit"\n        defaultTag: "main"\n        app:\n          dockerfilePath: "Dockerfile.frontend"\n          ports:\n            - 3000\n          env:\n            COMPONENT: "app"\n            ENV: "lifecycle"\n            API_URL: "https://{{{backend_publicUrl}}}"\n            CACHE_URL: "{{{cache_internalHostname}}}"\n            WES_IS: "GOAT"\n  - name: "backend"\n    requires:\n      - name: "db"\n    defaultUUID: "dev-0"\n    # ...\n  - name: "db"\n    defaultUUID: "dev-0"\n    # ...\n  - name: "cache"\n    defaultUUID: "dev-0"\n    # ...',tokens:[["environment","#7EE787"],[":","#C9D1D9"],"\n  ",["autoDeploy","#7EE787"],[":","#C9D1D9"]," ",["true","#79C0FF"],"\n  ",["defaultServices","#7EE787"],[":","#C9D1D9"],"\n    ",["-","#C9D1D9"]," ",["name","#7EE787"],[":","#C9D1D9"]," ",['"frontend"',"#A5D6FF"],"\n    ",["-","#C9D1D9"]," ",["name","#7EE787"],[":","#C9D1D9"]," ",['"backend"',"#A5D6FF"],"\n  ",["optionalServices","#7EE787"],[":","#C9D1D9"],"\n    ",["-","#C9D1D9"]," ",["name","#7EE787"],[":","#C9D1D9"]," ",['"cache"',"#A5D6FF"],"\n\n",["services","#7EE787"],[":","#C9D1D9"],"\n  ",["-","#C9D1D9"]," ",["name","#7EE787"],[":","#C9D1D9"]," ",['"frontend"',"#A5D6FF"],"\n    ",["defaultUUID","#7EE787"],[":","#C9D1D9"]," ",['"dev-0"',"#A5D6FF"],"\n    ",["github","#7EE787"],[":","#C9D1D9"],"\n      ",["repository","#7EE787"],[":","#C9D1D9"]," ",['"iceycake/lifecycle-examples"',"#A5D6FF"],"\n      ",["branchName","#7EE787"],[":","#C9D1D9"]," ",['"main"',"#A5D6FF"],"\n      ",["docker","#7EE787"],[":","#C9D1D9"],"\n        ",["builder","#7EE787"],[":","#C9D1D9"],"\n          ",["engine","#7EE787"],[":","#C9D1D9"]," ",['"buildkit"',"#A5D6FF"],"\n        ",["defaultTag","#7EE787"],[":","#C9D1D9"]," ",['"main"',"#A5D6FF"],"\n        ",["app","#7EE787"],[":","#C9D1D9"],"\n          ",["dockerfilePath","#7EE787"],[":","#C9D1D9"]," ",['"Dockerfile.frontend"',"#A5D6FF"],"\n          ",["ports","#7EE787"],[":","#C9D1D9"],"\n            ",["-","#C9D1D9"]," ",["3000","#79C0FF"],"\n          ",["env","#7EE787"],[":","#C9D1D9"],"\n            ",["COMPONENT","#7EE787"],[":","#C9D1D9"]," ",['"app"',"#A5D6FF"],"\n            ",["ENV","#7EE787"],[":","#C9D1D9"]," ",['"lifecycle"',"#A5D6FF"],"\n            ",["API_URL","#7EE787"],[":","#C9D1D9"]," ",['"https://{{{backend_publicUrl}}}"',"#A5D6FF"],"\n            ",["CACHE_URL","#7EE787"],[":","#C9D1D9"]," ",['"{{{cache_internalHostname}}}"',"#A5D6FF"],"\n            ",["WES_IS","#7EE787"],[":","#C9D1D9"]," ",['"GOAT"',"#A5D6FF"],"\n  ",["-","#C9D1D9"]," ",["name","#7EE787"],[":","#C9D1D9"]," ",['"backend"',"#A5D6FF"],"\n    ",["requires","#7EE787"],[":","#C9D1D9"],"\n      ",["-","#C9D1D9"]," ",["name","#7EE787"],[":","#C9D1D9"]," ",['"db"',"#A5D6FF"],"\n    ",["defaultUUID","#7EE787"],[":","#C9D1D9"]," ",['"dev-0"',"#A5D6FF"],"\n    ",["# ...","#8B949E"],"\n  ",["-","#C9D1D9"]," ",["name","#7EE787"],[":","#C9D1D9"]," ",['"db"',"#A5D6FF"],"\n    ",["defaultUUID","#7EE787"],[":","#C9D1D9"]," ",['"dev-0"',"#A5D6FF"],"\n    ",["# ...","#8B949E"],"\n  ",["-","#C9D1D9"]," ",["name","#7EE787"],[":","#C9D1D9"]," ",['"cache"',"#A5D6FF"],"\n    ",["defaultUUID","#7EE787"],[":","#C9D1D9"]," ",['"dev-0"',"#A5D6FF"],"\n    ",["# ...","#8B949E"]],annotations:[],themeName:"github-dark",style:{color:"#c9d1d9",background:"#0d1117",colorScheme:"dark"}}}),"\n",(0,t.jsx)(i.h3,{id:n[1].id,children:n[1].value}),"\n",(0,t.jsxs)(i.p,{children:["We have our dependencies defined in ",(0,t.jsx)(i.strong,{children:(0,t.jsx)(i.code,{children:"defaultServices"})})," and ",(0,t.jsx)(i.strong,{children:(0,t.jsx)(i.code,{children:"optionalServices"})}),":"]}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.strong,{children:(0,t.jsx)(i.code,{children:"defaultServices"})})," – These services are always ",(0,t.jsx)(i.strong,{children:"built and deployed"})," with the environment. They form the core foundation of the environment and are required for it to function correctly."]}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.strong,{children:(0,t.jsx)(i.code,{children:"optionalServices"})})," – These services ",(0,t.jsx)(i.strong,{children:"can be built on demand"}),", only when explicitly needed. If they are not selected during a PR, they default to using a ",(0,t.jsx)(i.strong,{children:"static environment"})," (e.g., ",(0,t.jsx)(i.code,{children:"dev-0"}),")."]}),"\n"]}),"\n",(0,t.jsx)(i.h3,{id:n[2].id,children:n[2].value}),"\n",(0,t.jsxs)(i.p,{children:["Notice how there are template variables defined in service named ",(0,t.jsx)(i.code,{children:"frontend"})," > ",(0,t.jsx)(i.code,{children:"github.docker.env"}),":"]}),"\n",(0,t.jsx)(r,{codeblock:{value:'API_URL: "https://{{{backend_publicUrl}}}"\nCACHE_URL: "{{{cache_internalHostname}}}"',lang:"yaml",meta:"",code:'API_URL: "https://{{{backend_publicUrl}}}"\nCACHE_URL: "{{{cache_internalHostname}}}"',tokens:[["API_URL","#7EE787"],[":","#C9D1D9"]," ",['"https://{{{backend_publicUrl}}}"',"#A5D6FF"],"\n",["CACHE_URL","#7EE787"],[":","#C9D1D9"]," ",['"{{{cache_internalHostname}}}"',"#A5D6FF"]],annotations:[],themeName:"github-dark",style:{color:"#c9d1d9",background:"#0d1117",colorScheme:"dark"}}}),"\n",(0,t.jsxs)(i.p,{children:["This ",(0,t.jsx)(i.code,{children:"API_URL"})," and ",(0,t.jsx)(i.code,{children:"CACHE_URL"})," variables are dynamically templated by Lifecycle and provided during the ",(0,t.jsx)(i.strong,{children:"build"})," and ",(0,t.jsx)(i.strong,{children:"deploy"})," steps for the frontend service."]}),"\n",(0,t.jsx)(o.P,{type:"info",children:(0,t.jsxs)(i.p,{children:["Read more about supported template variables\n",(0,t.jsx)(i.a,{href:"/docs/features/template-variables",children:"here"})]})}),"\n",(0,t.jsx)(i.h2,{id:n[3].id,children:n[3].value}),"\n",(0,t.jsxs)(i.p,{children:["Since ",(0,t.jsx)(i.code,{children:"cache"})," is an ",(0,t.jsx)(i.strong,{children:"optional service"}),", this service defaulted to using a ",(0,t.jsx)(i.strong,{children:"static environment"}),"(",(0,t.jsx)(i.code,{children:"dev-0"}),") as a fallback. This allows us to reuse existing environments instead of rebuilding everything from scratch when there are no changes."]}),"\n",(0,t.jsx)(i.h3,{id:n[4].id,children:n[4].value}),"\n",(0,t.jsx)(i.p,{children:"To view how the fallback URL works,"}),"\n",(0,t.jsxs)(i.ol,{children:["\n",(0,t.jsxs)(i.li,{children:["Open your ",(0,t.jsx)(i.strong,{children:"Tasks App"}),"(frontend) from the deployed environment."]}),"\n",(0,t.jsxs)(i.li,{children:["Navigate to the ",(0,t.jsx)(i.code,{children:"Variables"})," page."]}),"\n",(0,t.jsxs)(i.li,{children:["Search for ",(0,t.jsx)(i.code,{children:"_URL"})," and check its value.","\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsxs)(i.li,{children:["It should look like:","\n",(0,t.jsx)(r,{codeblock:{value:"API_URL: https://backend-<build_uuid>.<your_domain>\nCACHE_URL: cache-dev-0.env-dev-0.svc.cluster.local",lang:"txt",meta:"",code:"API_URL: https://backend-<build_uuid>.<your_domain>\nCACHE_URL: cache-dev-0.env-dev-0.svc.cluster.local",tokens:[["API_URL: https://backend-<build_uuid>.<your_domain>","#C9D1D9"],"\n",["CACHE_URL: cache-dev-0.env-dev-0.svc.cluster.local","#C9D1D9"]],annotations:[],themeName:"github-dark",style:{color:"#c9d1d9",background:"#0d1117",colorScheme:"dark"}}}),"\n"]}),"\n",(0,t.jsxs)(i.li,{children:["Notice how ",(0,t.jsx)(i.code,{children:"CACHE_URL"})," defaults to the ",(0,t.jsx)(i.code,{children:"dev-0"}),"(static) environment for the optional cache."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(i.h2,{id:n[5].id,children:n[5].value}),"\n",(0,t.jsxs)(i.p,{children:["Now, let’s say you also want to the ",(0,t.jsx)(i.code,{children:"cache"})," component to ",(0,t.jsx)(i.strong,{children:"test, build and deploy it in your environment"}),"."]}),"\n",(0,t.jsx)(i.h3,{id:n[6].id,children:n[6].value}),"\n",(0,t.jsxs)(i.ol,{children:["\n",(0,t.jsxs)(i.li,{children:["Navigate to the ",(0,t.jsx)(i.strong,{children:"Lifecycle PR comment"})," on GitHub."]}),"\n",(0,t.jsxs)(i.li,{children:["Select the ",(0,t.jsx)(i.code,{children:"cache"})," checkbox in the comment. That’s it!"]}),"\n",(0,t.jsxs)(i.li,{children:["Lifecycle will now start ",(0,t.jsx)(i.strong,{children:"building and deploying the cache service"})," for your specific environment."]}),"\n",(0,t.jsxs)(i.li,{children:["Wait for the build to complete. You can monitor the progress in the ",(0,t.jsx)(i.strong,{children:"status comment"}),"."]}),"\n"]}),"\n",(0,t.jsx)(i.h3,{id:n[7].id,children:n[7].value}),"\n",(0,t.jsxs)(i.ol,{start:"5",children:["\n",(0,t.jsxs)(i.li,{children:["Once the cache is deployed, go back to your ",(0,t.jsx)(i.strong,{children:"frontend app’s Variables page"}),"."]}),"\n",(0,t.jsxs)(i.li,{children:["Check the ",(0,t.jsx)(i.code,{children:"CACHE_URL"})," value.","\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsxs)(i.li,{children:["It should now look like:","\n",(0,t.jsx)(r,{codeblock:{value:"cache-<build_uuid>.env-<build_uuid>.svc.cluster.local",lang:"txt",meta:"",code:"cache-<build_uuid>.env-<build_uuid>.svc.cluster.local",tokens:[["cache-<build_uuid>.env-<build_uuid>.svc.cluster.local","#C9D1D9"]],annotations:[],themeName:"github-dark",style:{color:"#c9d1d9",background:"#0d1117",colorScheme:"dark"}}}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(i.li,{children:["Now, you’re running your cache ",(0,t.jsx)(i.strong,{children:"from your own environment"})," instead of an existing static deploy!"]}),"\n",(0,t.jsxs)(i.li,{children:["Check the application’s ",(0,t.jsx)(i.strong,{children:"Tasks"})," page while you’re here and observe the completely different data, as this environment uses a freshly built and seeded database."]}),"\n"]}),"\n",(0,t.jsx)(i.h2,{id:n[8].id,children:n[8].value}),"\n",(0,t.jsx)(i.p,{children:"With this approach, you can:"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsxs)(i.li,{children:["Build ",(0,t.jsx)(i.strong,{children:"any combination"})," of frontend and backend services."]}),"\n",(0,t.jsxs)(i.li,{children:["Use ",(0,t.jsx)(i.strong,{children:"custom branches"})," for different services."]}),"\n",(0,t.jsxs)(i.li,{children:["Test ",(0,t.jsx)(i.strong,{children:"different versions"})," of your app."]}),"\n"]}),"\n",(0,t.jsx)(o.P,{type:"info",children:(0,t.jsxs)(i.p,{children:["Check how to use Mission Control comments for configuring your environment\n",(0,t.jsx)(i.a,{href:"/docs/tips/using-mission-control",children:"here"})]})}),"\n",(0,t.jsxs)(i.p,{children:["This gives you a ",(0,t.jsx)(i.strong,{children:"custom, isolated testing environment"})," that mirrors your\nproduction setup while allowing flexibility in development and validation."]}),"\n",(0,t.jsx)(i.h2,{id:n[9].id,children:n[9].value}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsxs)(i.li,{children:["Services marked as ",(0,t.jsx)(i.strong,{children:"optional"})," in ",(0,t.jsx)(i.code,{children:"lifecycle.yaml"})," will default to static environments unless explicitly built."]}),"\n",(0,t.jsxs)(i.li,{children:["You can enable/disable any service directly from the ",(0,t.jsx)(i.strong,{children:"Lifecycle PR comment"}),"."]}),"\n",(0,t.jsx)(i.li,{children:"Lifecycle automates dependency management, ensuring your services deploy in the correct order."}),"\n"]}),"\n",(0,t.jsxs)(i.p,{children:[(0,t.jsx)(i.strong,{children:"Now you’re ready to customize your Lifecycle environments like a pro!"})," \uD83D\uDC69‍\uD83D\uDCBB"]})]})},"/docs/getting-started/configure-environment",{filePath:"src/pages/docs/getting-started/configure-environment.mdx",timestamp:1749151021e3,pageMap:l.O,frontMatter:{title:"Configure environment",tags:["tutorial","configure","edit"]},title:"Configure environment"},"undefined"==typeof RemoteContent?a:RemoteContent.useTOC)}},e=>{var n=n=>e(e.s=n);e.O(0,[4674,636,6593,8792],()=>n(4414)),_N_E=e.O()}]);