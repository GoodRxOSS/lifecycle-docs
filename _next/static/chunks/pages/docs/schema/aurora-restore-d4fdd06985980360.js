(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7157],{1513:(e,n,r)=>{"use strict";r.d(n,{R:()=>d});var t=r(91668),a=r(54587),s=r.n(a),o=r(14232);let i={img:e=>(0,o.createElement)("object"==typeof e.src?s():"img",e)},d=e=>(0,t.R)({...i,...e})},5120:(e,n,r)=>{"use strict";r.r(n),r.d(n,{default:()=>c,useTOC:()=>d});var t=r(37876),a=r(71807),s=r(1781),o=r(1513),i=r(19941);function d(e){return[{value:"Required Fields",id:"required-fields",depth:2},{value:"How It Works",id:"how-it-works",depth:2},{value:"Example",id:"example",depth:2},{value:"Use Cases",id:"use-cases",depth:2},{value:"Implementation Notes",id:"implementation-notes",depth:2}]}let c=(0,a.e)(function(e){let{toc:n=d(e)}=e,r={code:"code",h2:"h2",li:"li",ol:"ol",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,o.R)(),...e.components},{Code:a}=r;return a||function(e,n){throw Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Code",!0),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(r.p,{children:["The ",(0,t.jsx)(r.code,{children:"auroraRestore"})," service type restores AWS Aurora database snapshots for use in ephemeral environments. This allows you to test against production-like data."]}),"\n",(0,t.jsx)(i.P,{type:"warning",children:(0,t.jsx)(r.p,{children:"This documentation is still in progress and will be updated shortly with the\nlatest information."})}),"\n",(0,t.jsx)(r.h2,{id:n[0].id,children:n[0].value}),"\n",(0,t.jsxs)(r.table,{children:[(0,t.jsx)(r.thead,{children:(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.th,{children:"Field"}),(0,t.jsx)(r.th,{children:"Type"}),(0,t.jsx)(r.th,{children:"Description"})]})}),(0,t.jsxs)(r.tbody,{children:[(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"command"})}),(0,t.jsx)(r.td,{children:"string"}),(0,t.jsx)(r.td,{children:"Command to execute for the restore operation"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"arguments"})}),(0,t.jsx)(r.td,{children:"string"}),(0,t.jsx)(r.td,{children:"Arguments passed to the command"})]})]})]}),"\n",(0,t.jsx)(a,{codeblock:{value:'services:\n  - name: "database-restore"\n    auroraRestore:\n      command: "/restore/run.sh" # Required\n      arguments: "--snapshot-id latest" # Required',lang:"yaml",meta:'filename="lifecycle.yaml"',code:'services:\n  - name: "database-restore"\n    auroraRestore:\n      command: "/restore/run.sh" # Required\n      arguments: "--snapshot-id latest" # Required',tokens:[["services","#7EE787"],[":","#C9D1D9"],"\n  ",["-","#C9D1D9"]," ",["name","#7EE787"],[":","#C9D1D9"]," ",['"database-restore"',"#A5D6FF"],"\n    ",["auroraRestore","#7EE787"],[":","#C9D1D9"],"\n      ",["command","#7EE787"],[":","#C9D1D9"]," ",['"/restore/run.sh"',"#A5D6FF"]," ",["# Required","#8B949E"],"\n      ",["arguments","#7EE787"],[":","#C9D1D9"]," ",['"--snapshot-id latest"',"#A5D6FF"]," ",["# Required","#8B949E"]],annotations:[],themeName:"github-dark",style:{color:"#c9d1d9",background:"#0d1117",colorScheme:"dark"}}}),"\n",(0,t.jsx)(r.h2,{id:n[1].id,children:n[1].value}),"\n",(0,t.jsxs)(r.ol,{children:["\n",(0,t.jsx)(r.li,{children:"When the environment is deployed, Lifecycle executes the configured command with arguments"}),"\n",(0,t.jsx)(r.li,{children:"The command typically triggers an Aurora snapshot restore process"}),"\n",(0,t.jsx)(r.li,{children:"Once complete, the restored database is available for other services"}),"\n"]}),"\n",(0,t.jsx)(i.P,{type:"info",children:(0,t.jsxs)(r.p,{children:["The ",(0,t.jsx)(r.code,{children:"auroraRestore"})," service type is a specialized service that runs a command\nto initiate database restoration. The actual restore logic is implemented in\nyour command/script."]})}),"\n",(0,t.jsx)(r.h2,{id:n[2].id,children:n[2].value}),"\n",(0,t.jsx)(a,{codeblock:{value:'environment:\n  defaultServices:\n    - name: "api"\n    - name: "aurora-db"\n\nservices:\n  - name: "api"\n    github:\n      repository: "myorg/api"\n      branchName: "main"\n      docker:\n        defaultTag: "main"\n        app:\n          dockerfilePath: "Dockerfile"\n          env:\n            DATABASE_URL: "{{aurora-db_internalHostname}}:5432"\n          ports:\n            - 3000\n\n  - name: "aurora-db"\n    auroraRestore:\n      command: "/scripts/restore-aurora.sh"\n      arguments: "--cluster my-cluster --snapshot production-backup"',lang:"yaml",meta:'filename="lifecycle.yaml"',code:'environment:\n  defaultServices:\n    - name: "api"\n    - name: "aurora-db"\n\nservices:\n  - name: "api"\n    github:\n      repository: "myorg/api"\n      branchName: "main"\n      docker:\n        defaultTag: "main"\n        app:\n          dockerfilePath: "Dockerfile"\n          env:\n            DATABASE_URL: "{{aurora-db_internalHostname}}:5432"\n          ports:\n            - 3000\n\n  - name: "aurora-db"\n    auroraRestore:\n      command: "/scripts/restore-aurora.sh"\n      arguments: "--cluster my-cluster --snapshot production-backup"',tokens:[["environment","#7EE787"],[":","#C9D1D9"],"\n  ",["defaultServices","#7EE787"],[":","#C9D1D9"],"\n    ",["-","#C9D1D9"]," ",["name","#7EE787"],[":","#C9D1D9"]," ",['"api"',"#A5D6FF"],"\n    ",["-","#C9D1D9"]," ",["name","#7EE787"],[":","#C9D1D9"]," ",['"aurora-db"',"#A5D6FF"],"\n\n",["services","#7EE787"],[":","#C9D1D9"],"\n  ",["-","#C9D1D9"]," ",["name","#7EE787"],[":","#C9D1D9"]," ",['"api"',"#A5D6FF"],"\n    ",["github","#7EE787"],[":","#C9D1D9"],"\n      ",["repository","#7EE787"],[":","#C9D1D9"]," ",['"myorg/api"',"#A5D6FF"],"\n      ",["branchName","#7EE787"],[":","#C9D1D9"]," ",['"main"',"#A5D6FF"],"\n      ",["docker","#7EE787"],[":","#C9D1D9"],"\n        ",["defaultTag","#7EE787"],[":","#C9D1D9"]," ",['"main"',"#A5D6FF"],"\n        ",["app","#7EE787"],[":","#C9D1D9"],"\n          ",["dockerfilePath","#7EE787"],[":","#C9D1D9"]," ",['"Dockerfile"',"#A5D6FF"],"\n          ",["env","#7EE787"],[":","#C9D1D9"],"\n            ",["DATABASE_URL","#7EE787"],[":","#C9D1D9"]," ",['"{{aurora-db_internalHostname}}:5432"',"#A5D6FF"],"\n          ",["ports","#7EE787"],[":","#C9D1D9"],"\n            ",["-","#C9D1D9"]," ",["3000","#79C0FF"],"\n\n  ",["-","#C9D1D9"]," ",["name","#7EE787"],[":","#C9D1D9"]," ",['"aurora-db"',"#A5D6FF"],"\n    ",["auroraRestore","#7EE787"],[":","#C9D1D9"],"\n      ",["command","#7EE787"],[":","#C9D1D9"]," ",['"/scripts/restore-aurora.sh"',"#A5D6FF"],"\n      ",["arguments","#7EE787"],[":","#C9D1D9"]," ",['"--cluster my-cluster --snapshot production-backup"',"#A5D6FF"]],annotations:[],themeName:"github-dark",style:{color:"#c9d1d9",background:"#0d1117",colorScheme:"dark"}}}),"\n",(0,t.jsx)(r.h2,{id:n[3].id,children:n[3].value}),"\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.strong,{children:"Production data testing"})," - Test features against realistic production data"]}),"\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.strong,{children:"Database migrations"})," - Validate migrations against production schema"]}),"\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.strong,{children:"Performance testing"})," - Benchmark against production-scale data"]}),"\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.strong,{children:"Bug reproduction"})," - Reproduce issues with production data state"]}),"\n"]}),"\n",(0,t.jsx)(i.P,{type:"warning",children:(0,t.jsx)(r.p,{children:"When restoring from production snapshots, ensure sensitive data is properly\nanonymized or that access is appropriately restricted."})}),"\n",(0,t.jsx)(r.h2,{id:n[4].id,children:n[4].value}),"\n",(0,t.jsx)(r.p,{children:"The restore command is executed as part of the environment deployment process. Your script should:"}),"\n",(0,t.jsxs)(r.ol,{children:["\n",(0,t.jsx)(r.li,{children:"Handle authentication with AWS"}),"\n",(0,t.jsx)(r.li,{children:"Initiate the snapshot restore"}),"\n",(0,t.jsx)(r.li,{children:"Wait for the restore to complete"}),"\n",(0,t.jsx)(r.li,{children:"Configure network access to the restored instance"}),"\n",(0,t.jsx)(r.li,{children:"Return the connection information"}),"\n"]}),"\n",(0,t.jsx)(r.p,{children:"The restored database endpoint can then be referenced by other services using template variables."})]})},"/docs/schema/aurora-restore",{filePath:"src/pages/docs/schema/aurora-restore.mdx",timestamp:1770078729e3,pageMap:s.O,frontMatter:{title:"Aurora Restore Service",description:"Restore AWS Aurora database snapshots for ephemeral environments",tags:["schema","aurora","database","aws","restore"]},title:"Aurora Restore Service"},"undefined"==typeof RemoteContent?d:RemoteContent.useTOC)},71807:(e,n,r)=>{"use strict";r.d(n,{e:()=>c});var t=r(37876),a=r(20181),s=r(27096);let o=(0,r(14232).createContext)({}),i=o.Provider;o.displayName="SSG";var d=r(1513);function c(e,n,r,t){let s=globalThis[a.VZ];return s.route=n,s.pageMap=r.pageMap,s.context[n]={Content:e,pageOpts:r,useTOC:t},l}function l({__nextra_pageMap:e=[],__nextra_dynamic_opts:n,...r}){let o=globalThis[a.VZ],{Layout:d,themeConfig:c}=o,{route:l,locale:u}=(0,s.r)(),m=o.context[l];if(!m)throw Error(`No content found for the "${l}" route. Please report it as a bug.`);let{pageOpts:p,useTOC:D,Content:x}=m;if(l.startsWith("/["))p.pageMap=e;else for(let{route:n,children:r}of e){let e=n.split("/").slice(u?2:1);(function e(n,[r,...t]){for(let a of n)if("children"in a&&r===a.name)return t.length?e(a.children,t):a})(p.pageMap,e).children=r}if(n){let{title:e,frontMatter:r}=n;p={...p,title:e,frontMatter:r}}return(0,t.jsx)(d,{themeConfig:c,pageOpts:p,pageProps:r,children:(0,t.jsx)(i,{value:r,children:(0,t.jsx)(h,{useTOC:D,children:(0,t.jsx)(x,{...r})})})})}function h({children:e,useTOC:n}){let{wrapper:r}=(0,d.R)();return(0,t.jsx)(u,{useTOC:n,wrapper:r,children:e})}function u({children:e,useTOC:n,wrapper:r,...a}){let s=n(a);return r?(0,t.jsx)(r,{toc:s,children:e}):e}},94986:(e,n,r)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/docs/schema/aurora-restore",function(){return r(5120)}])}},e=>{var n=n=>e(e.s=n);e.O(0,[1781,636,6593,8792],()=>n(94986)),_N_E=e.O()}]);