(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6585],{1513:(e,n,i)=>{"use strict";i.d(n,{R:()=>l});var r=i(91668),d=i(54587),t=i.n(d),s=i(14232);let o={img:e=>(0,s.createElement)("object"==typeof e.src?t():"img",e)},l=e=>(0,r.R)({...o,...e})},25462:(e,n,i)=>{"use strict";i.r(n),i.d(n,{default:()=>c,useTOC:()=>l});var r=i(37876),d=i(71807),t=i(1781),s=i(1513),o=i(19941);function l(e){return[{value:"Example",id:"example",depth:2},{value:"Required Fields",id:"required-fields",depth:2},{value:"Optional Fields",id:"optional-fields",depth:2},{value:"Pipeline Configuration",id:"pipeline-configuration",depth:2},{value:"deploy",id:"deploy",depth:3},{value:"destroy",id:"destroy",depth:3},{value:"Environment Variables",id:"environment-variables",depth:2},{value:"How It Works",id:"how-it-works",depth:2},{value:"Use Cases",id:"use-cases",depth:2},{value:"Finding Pipeline IDs",id:"finding-pipeline-ids",depth:2}]}let c=(0,d.e)(function(e){let{toc:n=l(e)}=e,i={code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components},{Code:d}=i;return d||function(e,n){throw Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Code",!0),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(i.p,{children:["The ",(0,r.jsx)(i.code,{children:"codefresh"})," service type delegates deployment to external Codefresh pipelines. This is useful when you have existing CI/CD pipelines that handle complex build and deployment logic."]}),"\n",(0,r.jsx)(i.h2,{id:n[0].id,children:n[0].value}),"\n",(0,r.jsx)(d,{codeblock:{value:'services:\n  - name: "api"\n    codefresh:\n      repository: "myorg/api" # Required - GitHub repo in owner/repo format\n      branchName: "main" # Required - branch to build from\n      env: # Environment variables passed to pipelines\n        ENVIRONMENT: "ephemeral"\n        DATABASE_URL: "postgres://{{database_internalHostname}}:5432/app"\n        CACHE_URL: "redis://{{cache_internalHostname}}:6379"\n        LOG_LEVEL: "info"\n      deploy: # Required - deployment pipeline configuration\n        pipelineId: "64598362453cc650c0c9cd4d" # Codefresh pipeline ID for deployment\n        trigger: "lifecycle-deploy" # Pipeline trigger name\n      destroy: # Required - destruction pipeline configuration\n        pipelineId: "74283905723ff650c0d9ab7e" # Codefresh pipeline ID for destruction\n        trigger: "lifecycle-destroy" # Pipeline trigger name',lang:"yaml",meta:'filename="lifecycle.yaml"',code:'services:\n  - name: "api"\n    codefresh:\n      repository: "myorg/api" # Required - GitHub repo in owner/repo format\n      branchName: "main" # Required - branch to build from\n      env: # Environment variables passed to pipelines\n        ENVIRONMENT: "ephemeral"\n        DATABASE_URL: "postgres://{{database_internalHostname}}:5432/app"\n        CACHE_URL: "redis://{{cache_internalHostname}}:6379"\n        LOG_LEVEL: "info"\n      deploy: # Required - deployment pipeline configuration\n        pipelineId: "64598362453cc650c0c9cd4d" # Codefresh pipeline ID for deployment\n        trigger: "lifecycle-deploy" # Pipeline trigger name\n      destroy: # Required - destruction pipeline configuration\n        pipelineId: "74283905723ff650c0d9ab7e" # Codefresh pipeline ID for destruction\n        trigger: "lifecycle-destroy" # Pipeline trigger name',tokens:[["services","#7EE787"],[":","#C9D1D9"],"\n  ",["-","#C9D1D9"]," ",["name","#7EE787"],[":","#C9D1D9"]," ",['"api"',"#A5D6FF"],"\n    ",["codefresh","#7EE787"],[":","#C9D1D9"],"\n      ",["repository","#7EE787"],[":","#C9D1D9"]," ",['"myorg/api"',"#A5D6FF"]," ",["# Required - GitHub repo in owner/repo format","#8B949E"],"\n      ",["branchName","#7EE787"],[":","#C9D1D9"]," ",['"main"',"#A5D6FF"]," ",["# Required - branch to build from","#8B949E"],"\n      ",["env","#7EE787"],[":","#C9D1D9"]," ",["# Environment variables passed to pipelines","#8B949E"],"\n        ",["ENVIRONMENT","#7EE787"],[":","#C9D1D9"]," ",['"ephemeral"',"#A5D6FF"],"\n        ",["DATABASE_URL","#7EE787"],[":","#C9D1D9"]," ",['"postgres://{{database_internalHostname}}:5432/app"',"#A5D6FF"],"\n        ",["CACHE_URL","#7EE787"],[":","#C9D1D9"]," ",['"redis://{{cache_internalHostname}}:6379"',"#A5D6FF"],"\n        ",["LOG_LEVEL","#7EE787"],[":","#C9D1D9"]," ",['"info"',"#A5D6FF"],"\n      ",["deploy","#7EE787"],[":","#C9D1D9"]," ",["# Required - deployment pipeline configuration","#8B949E"],"\n        ",["pipelineId","#7EE787"],[":","#C9D1D9"]," ",['"64598362453cc650c0c9cd4d"',"#A5D6FF"]," ",["# Codefresh pipeline ID for deployment","#8B949E"],"\n        ",["trigger","#7EE787"],[":","#C9D1D9"]," ",['"lifecycle-deploy"',"#A5D6FF"]," ",["# Pipeline trigger name","#8B949E"],"\n      ",["destroy","#7EE787"],[":","#C9D1D9"]," ",["# Required - destruction pipeline configuration","#8B949E"],"\n        ",["pipelineId","#7EE787"],[":","#C9D1D9"]," ",['"74283905723ff650c0d9ab7e"',"#A5D6FF"]," ",["# Codefresh pipeline ID for destruction","#8B949E"],"\n        ",["trigger","#7EE787"],[":","#C9D1D9"]," ",['"lifecycle-destroy"',"#A5D6FF"]," ",["# Pipeline trigger name","#8B949E"]],annotations:[],themeName:"github-dark",style:{color:"#c9d1d9",background:"#0d1117",colorScheme:"dark"}}}),"\n",(0,r.jsx)(i.h2,{id:n[1].id,children:n[1].value}),"\n",(0,r.jsxs)(i.table,{children:[(0,r.jsx)(i.thead,{children:(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.th,{children:"Field"}),(0,r.jsx)(i.th,{children:"Type"}),(0,r.jsx)(i.th,{children:"Description"})]})}),(0,r.jsxs)(i.tbody,{children:[(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:(0,r.jsx)(i.code,{children:"repository"})}),(0,r.jsx)(i.td,{children:"string"}),(0,r.jsxs)(i.td,{children:["GitHub repository in ",(0,r.jsx)(i.code,{children:"owner/repo"})," format"]})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:(0,r.jsx)(i.code,{children:"branchName"})}),(0,r.jsx)(i.td,{children:"string"}),(0,r.jsx)(i.td,{children:"Branch to build from"})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:(0,r.jsx)(i.code,{children:"deploy.pipelineId"})}),(0,r.jsx)(i.td,{children:"string"}),(0,r.jsx)(i.td,{children:"Codefresh pipeline ID for deployment"})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:(0,r.jsx)(i.code,{children:"deploy.trigger"})}),(0,r.jsx)(i.td,{children:"string"}),(0,r.jsx)(i.td,{children:"Pipeline trigger name for deployment"})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:(0,r.jsx)(i.code,{children:"destroy.pipelineId"})}),(0,r.jsx)(i.td,{children:"string"}),(0,r.jsx)(i.td,{children:"Codefresh pipeline ID for destruction"})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:(0,r.jsx)(i.code,{children:"destroy.trigger"})}),(0,r.jsx)(i.td,{children:"string"}),(0,r.jsx)(i.td,{children:"Pipeline trigger name for destruction"})]})]})]}),"\n",(0,r.jsx)(i.h2,{id:n[2].id,children:n[2].value}),"\n",(0,r.jsxs)(i.table,{children:[(0,r.jsx)(i.thead,{children:(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.th,{children:"Field"}),(0,r.jsx)(i.th,{children:"Type"}),(0,r.jsx)(i.th,{children:"Description"})]})}),(0,r.jsx)(i.tbody,{children:(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:(0,r.jsx)(i.code,{children:"env"})}),(0,r.jsx)(i.td,{children:"object"}),(0,r.jsx)(i.td,{children:"Environment variables passed to pipelines"})]})})]}),"\n",(0,r.jsx)(i.h2,{id:n[3].id,children:n[3].value}),"\n",(0,r.jsx)(i.h3,{id:n[4].id,children:n[4].value}),"\n",(0,r.jsx)(i.p,{children:"Configure the pipeline triggered when deploying the service."}),"\n",(0,r.jsx)(d,{codeblock:{value:'codefresh:\n  deploy:\n    pipelineId: "64598362453cc650c0c9cd4d"\n    trigger: "deploy"',lang:"yaml",meta:"",code:'codefresh:\n  deploy:\n    pipelineId: "64598362453cc650c0c9cd4d"\n    trigger: "deploy"',tokens:[["codefresh","#7EE787"],[":","#C9D1D9"],"\n  ",["deploy","#7EE787"],[":","#C9D1D9"],"\n    ",["pipelineId","#7EE787"],[":","#C9D1D9"]," ",['"64598362453cc650c0c9cd4d"',"#A5D6FF"],"\n    ",["trigger","#7EE787"],[":","#C9D1D9"]," ",['"deploy"',"#A5D6FF"]],annotations:[],themeName:"github-dark",style:{color:"#c9d1d9",background:"#0d1117",colorScheme:"dark"}}}),"\n",(0,r.jsx)(i.h3,{id:n[5].id,children:n[5].value}),"\n",(0,r.jsx)(i.p,{children:"Configure the pipeline triggered when tearing down the environment."}),"\n",(0,r.jsx)(d,{codeblock:{value:'codefresh:\n  destroy:\n    pipelineId: "74283905723ff650c0d9ab7e"\n    trigger: "destroy"',lang:"yaml",meta:"",code:'codefresh:\n  destroy:\n    pipelineId: "74283905723ff650c0d9ab7e"\n    trigger: "destroy"',tokens:[["codefresh","#7EE787"],[":","#C9D1D9"],"\n  ",["destroy","#7EE787"],[":","#C9D1D9"],"\n    ",["pipelineId","#7EE787"],[":","#C9D1D9"]," ",['"74283905723ff650c0d9ab7e"',"#A5D6FF"],"\n    ",["trigger","#7EE787"],[":","#C9D1D9"]," ",['"destroy"',"#A5D6FF"]],annotations:[],themeName:"github-dark",style:{color:"#c9d1d9",background:"#0d1117",colorScheme:"dark"}}}),"\n",(0,r.jsx)(i.h2,{id:n[6].id,children:n[6].value}),"\n",(0,r.jsx)(i.p,{children:"Pass environment variables to both deploy and destroy pipelines:"}),"\n",(0,r.jsx)(d,{codeblock:{value:'codefresh:\n  repository: "myorg/api"\n  branchName: "main"\n  env:\n    ENVIRONMENT: "ephemeral"\n    SERVICE_NAME: "api"\n    DATABASE_URL: "{{database_internalHostname}}:5432"',lang:"yaml",meta:"",code:'codefresh:\n  repository: "myorg/api"\n  branchName: "main"\n  env:\n    ENVIRONMENT: "ephemeral"\n    SERVICE_NAME: "api"\n    DATABASE_URL: "{{database_internalHostname}}:5432"',tokens:[["codefresh","#7EE787"],[":","#C9D1D9"],"\n  ",["repository","#7EE787"],[":","#C9D1D9"]," ",['"myorg/api"',"#A5D6FF"],"\n  ",["branchName","#7EE787"],[":","#C9D1D9"]," ",['"main"',"#A5D6FF"],"\n  ",["env","#7EE787"],[":","#C9D1D9"],"\n    ",["ENVIRONMENT","#7EE787"],[":","#C9D1D9"]," ",['"ephemeral"',"#A5D6FF"],"\n    ",["SERVICE_NAME","#7EE787"],[":","#C9D1D9"]," ",['"api"',"#A5D6FF"],"\n    ",["DATABASE_URL","#7EE787"],[":","#C9D1D9"]," ",['"{{database_internalHostname}}:5432"',"#A5D6FF"]],annotations:[],themeName:"github-dark",style:{color:"#c9d1d9",background:"#0d1117",colorScheme:"dark"}}}),"\n",(0,r.jsx)(o.P,{type:"info",children:(0,r.jsxs)(i.p,{children:["Environment variables defined in ",(0,r.jsx)(i.code,{children:"env"})," are passed to both deploy and destroy\npipelines. Use template variables to reference other services."]})}),"\n",(0,r.jsx)(i.h2,{id:n[7].id,children:n[7].value}),"\n",(0,r.jsxs)(i.ol,{children:["\n",(0,r.jsxs)(i.li,{children:["When an environment is deployed, Lifecycle triggers the ",(0,r.jsx)(i.code,{children:"deploy"})," pipeline with the configured environment variables."]}),"\n",(0,r.jsx)(i.li,{children:"The pipeline receives context about the deployment including branch, namespace, and service information."}),"\n",(0,r.jsxs)(i.li,{children:["When the environment is torn down, Lifecycle triggers the ",(0,r.jsx)(i.code,{children:"destroy"})," pipeline to clean up resources."]}),"\n"]}),"\n",(0,r.jsx)(i.h2,{id:n[8].id,children:n[8].value}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:"Complex build processes"})," - When builds require multi-stage pipelines or custom tooling"]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:"External dependencies"})," - When deployment requires interaction with external systems"]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:"Existing CI/CD"})," - When you have established Codefresh pipelines you want to reuse"]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:"Custom deployment logic"})," - When standard Kubernetes deployment isnâ€™t sufficient"]}),"\n"]}),"\n",(0,r.jsx)(o.P,{type:"warning",children:(0,r.jsx)(i.p,{children:"Codefresh pipelines run asynchronously. Lifecycle tracks pipeline status but\nthe actual deployment logic is managed by Codefresh."})}),"\n",(0,r.jsx)(i.h2,{id:n[9].id,children:n[9].value}),"\n",(0,r.jsx)(i.p,{children:"To find your Codefresh pipeline ID:"}),"\n",(0,r.jsxs)(i.ol,{children:["\n",(0,r.jsx)(i.li,{children:"Open your pipeline in Codefresh"}),"\n",(0,r.jsxs)(i.li,{children:["The pipeline ID is in the URL: ",(0,r.jsx)(i.code,{children:"https://g.codefresh.io/pipelines/edit/new/.../<pipeline-id>"})]}),"\n",(0,r.jsxs)(i.li,{children:["Or use the Codefresh CLI: ",(0,r.jsx)(i.code,{children:"codefresh get pipelines"})]}),"\n"]})]})},"/docs/schema/codefresh",{filePath:"src/pages/docs/schema/codefresh.mdx",timestamp:177162007e4,pageMap:t.O,frontMatter:{title:"Codefresh Service",description:"Trigger external Codefresh pipelines for deployment and destruction",tags:["schema","codefresh","pipeline","ci-cd"]},title:"Codefresh Service"},"undefined"==typeof RemoteContent?l:RemoteContent.useTOC)},42972:(e,n,i)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/docs/schema/codefresh",function(){return i(25462)}])},71807:(e,n,i)=>{"use strict";i.d(n,{e:()=>c});var r=i(37876),d=i(20181),t=i(27096);let s=(0,i(14232).createContext)({}),o=s.Provider;s.displayName="SSG";var l=i(1513);function c(e,n,i,r){let t=globalThis[d.VZ];return t.route=n,t.pageMap=i.pageMap,t.context[n]={Content:e,pageOpts:i,useTOC:r},a}function a({__nextra_pageMap:e=[],__nextra_dynamic_opts:n,...i}){let s=globalThis[d.VZ],{Layout:l,themeConfig:c}=s,{route:a,locale:h}=(0,t.r)(),u=s.context[a];if(!u)throw Error(`No content found for the "${a}" route. Please report it as a bug.`);let{pageOpts:f,useTOC:m,Content:g}=u;if(a.startsWith("/["))f.pageMap=e;else for(let{route:n,children:i}of e){let e=n.split("/").slice(h?2:1);(function e(n,[i,...r]){for(let d of n)if("children"in d&&i===d.name)return r.length?e(d.children,r):d})(f.pageMap,e).children=i}if(n){let{title:e,frontMatter:i}=n;f={...f,title:e,frontMatter:i}}return(0,r.jsx)(l,{themeConfig:c,pageOpts:f,pageProps:i,children:(0,r.jsx)(o,{value:i,children:(0,r.jsx)(p,{useTOC:m,children:(0,r.jsx)(g,{...i})})})})}function p({children:e,useTOC:n}){let{wrapper:i}=(0,l.R)();return(0,r.jsx)(h,{useTOC:n,wrapper:i,children:e})}function h({children:e,useTOC:n,wrapper:i,...d}){let t=n(d);return i?(0,r.jsx)(i,{toc:t,children:e}):e}}},e=>{var n=n=>e(e.s=n);e.O(0,[1781,636,6593,8792],()=>n(42972)),_N_E=e.O()}]);