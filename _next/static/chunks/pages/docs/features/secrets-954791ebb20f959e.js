(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[727],{1513:(e,n,r)=>{"use strict";r.d(n,{R:()=>c});var s=r(91668),t=r(54587),a=r.n(t),d=r(14232);let i={img:e=>(0,d.createElement)("object"==typeof e.src?a():"img",e)},c=e=>(0,s.R)({...i,...e})},16064:(e,n,r)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/docs/features/secrets",function(){return r(76280)}])},71807:(e,n,r)=>{"use strict";r.d(n,{e:()=>o});var s=r(37876),t=r(20181),a=r(27096);let d=(0,r(14232).createContext)({}),i=d.Provider;d.displayName="SSG";var c=r(1513);function o(e,n,r,s){let a=globalThis[t.VZ];return a.route=n,a.pageMap=r.pageMap,a.context[n]={Content:e,pageOpts:r,useTOC:s},l}function l({__nextra_pageMap:e=[],__nextra_dynamic_opts:n,...r}){let d=globalThis[t.VZ],{Layout:c,themeConfig:o}=d,{route:l,locale:p}=(0,a.r)(),D=d.context[l];if(!D)throw Error(`No content found for the "${l}" route. Please report it as a bug.`);let{pageOpts:u,useTOC:m,Content:x}=D;if(l.startsWith("/["))u.pageMap=e;else for(let{route:n,children:r}of e){let e=n.split("/").slice(p?2:1);(function e(n,[r,...s]){for(let t of n)if("children"in t&&r===t.name)return s.length?e(t.children,s):t})(u.pageMap,e).children=r}if(n){let{title:e,frontMatter:r}=n;u={...u,title:e,frontMatter:r}}return(0,s.jsx)(c,{themeConfig:o,pageOpts:u,pageProps:r,children:(0,s.jsx)(i,{value:r,children:(0,s.jsx)(h,{useTOC:m,children:(0,s.jsx)(x,{...r})})})})}function h({children:e,useTOC:n}){let{wrapper:r}=(0,c.R)();return(0,s.jsx)(p,{useTOC:n,wrapper:r,children:e})}function p({children:e,useTOC:n,wrapper:r,...t}){let a=n(t);return r?(0,s.jsx)(r,{toc:a,children:e}):e}},76280:(e,n,r)=>{"use strict";r.r(n),r.d(n,{default:()=>o,useTOC:()=>c});var s=r(37876),t=r(71807),a=r(1781),d=r(1513),i=r(19941);function c(e){return[{value:"Overview",id:"overview",depth:2},{value:"Configuration",id:"configuration",depth:2},{value:"Default Configuration",id:"default-configuration",depth:3},{value:"Configuration Fields",id:"configuration-fields",depth:3},{value:"Syntax",id:"syntax",depth:2},{value:"Basic Usage",id:"basic-usage",depth:2},{value:"JSON Secrets",id:"json-secrets",depth:3},{value:"Plaintext Secrets",id:"plaintext-secrets",depth:3},{value:"Nested JSON",id:"nested-json",depth:3},{value:"Where Secrets Work",id:"where-secrets-work",depth:2},{value:"GitHub Services",id:"github-services",depth:3},{value:"Docker Services",id:"docker-services",depth:3},{value:"Webhooks",id:"webhooks",depth:3},{value:"Mixing Secrets with Template Variables",id:"mixing-secrets-with-template-variables",depth:2},{value:"Multiple Providers",id:"multiple-providers",depth:2},{value:"Error Handling",id:"error-handling",depth:2},{value:"Best Practices",id:"best-practices",depth:2},{value:"Use Descriptive Secret Paths",id:"use-descriptive-secret-paths",depth:3},{value:"Group Related Secrets",id:"group-related-secrets",depth:3},{value:"Avoid Secrets in Build Logs",id:"avoid-secrets-in-build-logs",depth:3},{value:"Troubleshooting",id:"troubleshooting",depth:2},{value:"Secret Not Injected",id:"secret-not-injected",depth:3},{value:"Syntax Errors",id:"syntax-errors",depth:3},{value:"Permission Denied",id:"permission-denied",depth:3},{value:"Wrong Provider for Cluster",id:"wrong-provider-for-cluster",depth:3},{value:"Prerequisites",id:"prerequisites",depth:2},{value:"Related",id:"related",depth:2}]}let o=(0,t.e)(function(e){let{toc:n=c(e)}=e,r={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,d.R)(),...e.components},{Code:t}=r;return t||function(e,n){throw Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Code",!0),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(r.h2,{id:n[0].id,children:n[0].value}),"\n",(0,s.jsxs)(r.p,{children:["Lifecycle integrates with cloud secret providers to securely inject secrets into your ephemeral environments. You can reference secrets directly in your ",(0,s.jsx)(r.code,{children:"lifecycle.yaml"})," environment variables using a template syntax, and Lifecycle handles the rest."]}),"\n",(0,s.jsx)(r.p,{children:"Supported providers:"}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsx)(r.li,{children:(0,s.jsx)(r.strong,{children:"AWS Secrets Manager"})}),"\n",(0,s.jsx)(r.li,{children:(0,s.jsx)(r.strong,{children:"GCP Secret Manager"})}),"\n"]}),"\n",(0,s.jsx)(r.h2,{id:n[1].id,children:n[1].value}),"\n",(0,s.jsxs)(r.p,{children:["Secret providers are configured in the Lifecycle ",(0,s.jsx)(r.code,{children:"global_config"})," database table under the ",(0,s.jsx)(r.code,{children:"secretProviders"})," key."]}),"\n",(0,s.jsx)(r.h3,{id:n[2].id,children:n[2].value}),"\n",(0,s.jsxs)(r.p,{children:["Both AWS and GCP providers are ",(0,s.jsx)(r.strong,{children:"enabled by default"}),". The ClusterSecretStore created by your platform team determines which provider actually works in your cluster."]}),"\n",(0,s.jsx)(t,{codeblock:{value:'{\n  "secretProviders": {\n    "aws": {\n      "enabled": true,\n      "clusterSecretStore": "aws-secretsmanager",\n      "refreshInterval": "1h",\n      "allowedPrefixes": []\n    },\n    "gcp": {\n      "enabled": true,\n      "clusterSecretStore": "gcp-secretmanager",\n      "refreshInterval": "1h",\n      "allowedPrefixes": []\n    }\n  }\n}',lang:"json",meta:"",code:'{\n  "secretProviders": {\n    "aws": {\n      "enabled": true,\n      "clusterSecretStore": "aws-secretsmanager",\n      "refreshInterval": "1h",\n      "allowedPrefixes": []\n    },\n    "gcp": {\n      "enabled": true,\n      "clusterSecretStore": "gcp-secretmanager",\n      "refreshInterval": "1h",\n      "allowedPrefixes": []\n    }\n  }\n}',tokens:[["{","#C9D1D9"],"\n  ",['"secretProviders"',"#7EE787"],[": {","#C9D1D9"],"\n    ",['"aws"',"#7EE787"],[": {","#C9D1D9"],"\n      ",['"enabled"',"#7EE787"],[":","#C9D1D9"]," ",["true","#79C0FF"],[",","#C9D1D9"],"\n      ",['"clusterSecretStore"',"#7EE787"],[":","#C9D1D9"]," ",['"aws-secretsmanager"',"#A5D6FF"],[",","#C9D1D9"],"\n      ",['"refreshInterval"',"#7EE787"],[":","#C9D1D9"]," ",['"1h"',"#A5D6FF"],[",","#C9D1D9"],"\n      ",['"allowedPrefixes"',"#7EE787"],[": []","#C9D1D9"],"\n    ",["},","#C9D1D9"],"\n    ",['"gcp"',"#7EE787"],[": {","#C9D1D9"],"\n      ",['"enabled"',"#7EE787"],[":","#C9D1D9"]," ",["true","#79C0FF"],[",","#C9D1D9"],"\n      ",['"clusterSecretStore"',"#7EE787"],[":","#C9D1D9"]," ",['"gcp-secretmanager"',"#A5D6FF"],[",","#C9D1D9"],"\n      ",['"refreshInterval"',"#7EE787"],[":","#C9D1D9"]," ",['"1h"',"#A5D6FF"],[",","#C9D1D9"],"\n      ",['"allowedPrefixes"',"#7EE787"],[": []","#C9D1D9"],"\n    ",["}","#C9D1D9"],"\n  ",["}","#C9D1D9"],"\n",["}","#C9D1D9"]],annotations:[],themeName:"github-dark",style:{color:"#c9d1d9",background:"#0d1117",colorScheme:"dark"}}}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.strong,{children:"On AWS (EKS):"})," Use ",(0,s.jsx)(r.code,{children:"{{aws:path:key}}"})," syntax. The ",(0,s.jsx)(r.code,{children:"aws-secretsmanager"})," ClusterSecretStore handles the request."]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.strong,{children:"On GCP (GKE):"})," Use ",(0,s.jsx)(r.code,{children:"{{gcp:path:key}}"})," syntax. The ",(0,s.jsx)(r.code,{children:"gcp-secretmanager"})," ClusterSecretStore handles the request."]}),"\n"]}),"\n",(0,s.jsx)(r.p,{children:"If you reference a provider that doesn’t have a ClusterSecretStore in your cluster, the secret will fail to sync and a warning will be logged."}),"\n",(0,s.jsx)(r.h3,{id:n[3].id,children:n[3].value}),"\n",(0,s.jsxs)(r.table,{children:[(0,s.jsx)(r.thead,{children:(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.th,{children:"Field"}),(0,s.jsx)(r.th,{children:"Required"}),(0,s.jsx)(r.th,{children:"Description"})]})}),(0,s.jsxs)(r.tbody,{children:[(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.code,{children:"enabled"})}),(0,s.jsx)(r.td,{children:"Yes"}),(0,s.jsx)(r.td,{children:"Enable this provider"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.code,{children:"clusterSecretStore"})}),(0,s.jsx)(r.td,{children:"Yes"}),(0,s.jsx)(r.td,{children:"Name of the ClusterSecretStore CR configured by your platform team"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.code,{children:"refreshInterval"})}),(0,s.jsx)(r.td,{children:"Yes"}),(0,s.jsxs)(r.td,{children:["How often ESO syncs secrets (e.g., ",(0,s.jsx)(r.code,{children:"1h"}),", ",(0,s.jsx)(r.code,{children:"30m"}),")"]})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.code,{children:"allowedPrefixes"})}),(0,s.jsx)(r.td,{children:"No"}),(0,s.jsx)(r.td,{children:"Restrict which secret paths can be referenced (empty = allow all)"})]})]})]}),"\n",(0,s.jsx)(i.P,{type:"info",children:(0,s.jsxs)(r.p,{children:["If you’re unsure which ",(0,s.jsx)(r.code,{children:"clusterSecretStore"})," to use, check with your platform\nteam. They configure the External Secrets Operator and ClusterSecretStore as\npart of cluster setup."]})}),"\n",(0,s.jsx)(r.h2,{id:n[4].id,children:n[4].value}),"\n",(0,s.jsx)(r.p,{children:"Reference secrets using the following pattern:"}),"\n",(0,s.jsx)(t,{codeblock:{value:"{{<provider>:<secret-path>:<key>}}",lang:"txt",meta:"",code:"{{<provider>:<secret-path>:<key>}}",tokens:[["{{<provider>:<secret-path>:<key>}}","#C9D1D9"]],annotations:[],themeName:"github-dark",style:{color:"#c9d1d9",background:"#0d1117",colorScheme:"dark"}}}),"\n",(0,s.jsxs)(r.table,{children:[(0,s.jsx)(r.thead,{children:(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.th,{children:"Component"}),(0,s.jsx)(r.th,{children:"Description"}),(0,s.jsx)(r.th,{children:"Example"})]})}),(0,s.jsxs)(r.tbody,{children:[(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.code,{children:"provider"})}),(0,s.jsxs)(r.td,{children:["Cloud provider (",(0,s.jsx)(r.code,{children:"aws"})," or ",(0,s.jsx)(r.code,{children:"gcp"}),")"]}),(0,s.jsx)(r.td,{children:(0,s.jsx)(r.code,{children:"aws"})})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.code,{children:"secret-path"})}),(0,s.jsx)(r.td,{children:"Full path to the secret"}),(0,s.jsx)(r.td,{children:(0,s.jsx)(r.code,{children:"myapp/database-credentials"})})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.code,{children:"key"})}),(0,s.jsx)(r.td,{children:"JSON key within the secret (optional)"}),(0,s.jsx)(r.td,{children:(0,s.jsx)(r.code,{children:"password"})})]})]})]}),"\n",(0,s.jsx)(i.P,{type:"info",children:(0,s.jsxs)(r.p,{children:["If your secret is a plaintext value (not JSON), omit the key portion: ",(0,s.jsx)(r.code,{children:'   {"{{aws:myapp/api-key}}"}'}),"."]})}),"\n",(0,s.jsx)(r.h2,{id:n[5].id,children:n[5].value}),"\n",(0,s.jsx)(r.h3,{id:n[6].id,children:n[6].value}),"\n",(0,s.jsx)(r.p,{children:"For secrets stored as JSON objects, specify the key to extract:"}),"\n",(0,s.jsx)(t,{codeblock:{value:'services:\n  - name: api-server\n    github:\n      repository: myorg/api-server\n      branchName: main\n      docker:\n        app:\n          env:\n            DB_PASSWORD: "{{aws:myapp/rds-credentials:password}}"\n            DB_USERNAME: "{{aws:myapp/rds-credentials:username}}"\n            DB_HOST: "{{aws:myapp/rds-credentials:host}}"',lang:"yaml",meta:"",code:'services:\n  - name: api-server\n    github:\n      repository: myorg/api-server\n      branchName: main\n      docker:\n        app:\n          env:\n            DB_PASSWORD: "{{aws:myapp/rds-credentials:password}}"\n            DB_USERNAME: "{{aws:myapp/rds-credentials:username}}"\n            DB_HOST: "{{aws:myapp/rds-credentials:host}}"',tokens:[["services","#7EE787"],[":","#C9D1D9"],"\n  ",["-","#C9D1D9"]," ",["name","#7EE787"],[":","#C9D1D9"]," ",["api-server","#A5D6FF"],"\n    ",["github","#7EE787"],[":","#C9D1D9"],"\n      ",["repository","#7EE787"],[":","#C9D1D9"]," ",["myorg/api-server","#A5D6FF"],"\n      ",["branchName","#7EE787"],[":","#C9D1D9"]," ",["main","#A5D6FF"],"\n      ",["docker","#7EE787"],[":","#C9D1D9"],"\n        ",["app","#7EE787"],[":","#C9D1D9"],"\n          ",["env","#7EE787"],[":","#C9D1D9"],"\n            ",["DB_PASSWORD","#7EE787"],[":","#C9D1D9"]," ",['"{{aws:myapp/rds-credentials:password}}"',"#A5D6FF"],"\n            ",["DB_USERNAME","#7EE787"],[":","#C9D1D9"]," ",['"{{aws:myapp/rds-credentials:username}}"',"#A5D6FF"],"\n            ",["DB_HOST","#7EE787"],[":","#C9D1D9"]," ",['"{{aws:myapp/rds-credentials:host}}"',"#A5D6FF"]],annotations:[],themeName:"github-dark",style:{color:"#c9d1d9",background:"#0d1117",colorScheme:"dark"}}}),"\n",(0,s.jsxs)(r.p,{children:["If your AWS secret ",(0,s.jsx)(r.code,{children:"myapp/rds-credentials"})," contains:"]}),"\n",(0,s.jsx)(t,{codeblock:{value:'{\n  "username": "admin",\n  "password": "supersecret",\n  "host": "db.example.com"\n}',lang:"json",meta:"",code:'{\n  "username": "admin",\n  "password": "supersecret",\n  "host": "db.example.com"\n}',tokens:[["{","#C9D1D9"],"\n  ",['"username"',"#7EE787"],[":","#C9D1D9"]," ",['"admin"',"#A5D6FF"],[",","#C9D1D9"],"\n  ",['"password"',"#7EE787"],[":","#C9D1D9"]," ",['"supersecret"',"#A5D6FF"],[",","#C9D1D9"],"\n  ",['"host"',"#7EE787"],[":","#C9D1D9"]," ",['"db.example.com"',"#A5D6FF"],"\n",["}","#C9D1D9"]],annotations:[],themeName:"github-dark",style:{color:"#c9d1d9",background:"#0d1117",colorScheme:"dark"}}}),"\n",(0,s.jsx)(r.p,{children:"Your pod will receive:"}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsx)(r.li,{children:(0,s.jsx)(r.code,{children:"DB_USERNAME=admin"})}),"\n",(0,s.jsx)(r.li,{children:(0,s.jsx)(r.code,{children:"DB_PASSWORD=supersecret"})}),"\n",(0,s.jsx)(r.li,{children:(0,s.jsx)(r.code,{children:"DB_HOST=db.example.com"})}),"\n"]}),"\n",(0,s.jsx)(r.h3,{id:n[7].id,children:n[7].value}),"\n",(0,s.jsx)(r.p,{children:"For secrets stored as plain strings, omit the key:"}),"\n",(0,s.jsx)(t,{codeblock:{value:'env:\n  STRIPE_API_KEY: "{{aws:myapp/stripe-key}}"',lang:"yaml",meta:"",code:'env:\n  STRIPE_API_KEY: "{{aws:myapp/stripe-key}}"',tokens:[["env","#7EE787"],[":","#C9D1D9"],"\n  ",["STRIPE_API_KEY","#7EE787"],[":","#C9D1D9"]," ",['"{{aws:myapp/stripe-key}}"',"#A5D6FF"]],annotations:[],themeName:"github-dark",style:{color:"#c9d1d9",background:"#0d1117",colorScheme:"dark"}}}),"\n",(0,s.jsx)(r.h3,{id:n[8].id,children:n[8].value}),"\n",(0,s.jsx)(r.p,{children:"For nested JSON structures, use dot notation:"}),"\n",(0,s.jsx)(t,{codeblock:{value:'env:\n  REDIS_HOST: "{{aws:myapp/cache-config:redis.host}}"\n  REDIS_PORT: "{{aws:myapp/cache-config:redis.port}}"',lang:"yaml",meta:"",code:'env:\n  REDIS_HOST: "{{aws:myapp/cache-config:redis.host}}"\n  REDIS_PORT: "{{aws:myapp/cache-config:redis.port}}"',tokens:[["env","#7EE787"],[":","#C9D1D9"],"\n  ",["REDIS_HOST","#7EE787"],[":","#C9D1D9"]," ",['"{{aws:myapp/cache-config:redis.host}}"',"#A5D6FF"],"\n  ",["REDIS_PORT","#7EE787"],[":","#C9D1D9"]," ",['"{{aws:myapp/cache-config:redis.port}}"',"#A5D6FF"]],annotations:[],themeName:"github-dark",style:{color:"#c9d1d9",background:"#0d1117",colorScheme:"dark"}}}),"\n",(0,s.jsx)(r.p,{children:"For a secret containing:"}),"\n",(0,s.jsx)(t,{codeblock:{value:'{\n  "redis": {\n    "host": "redis.example.com",\n    "port": "6379"\n  }\n}',lang:"json",meta:"",code:'{\n  "redis": {\n    "host": "redis.example.com",\n    "port": "6379"\n  }\n}',tokens:[["{","#C9D1D9"],"\n  ",['"redis"',"#7EE787"],[": {","#C9D1D9"],"\n    ",['"host"',"#7EE787"],[":","#C9D1D9"]," ",['"redis.example.com"',"#A5D6FF"],[",","#C9D1D9"],"\n    ",['"port"',"#7EE787"],[":","#C9D1D9"]," ",['"6379"',"#A5D6FF"],"\n  ",["}","#C9D1D9"],"\n",["}","#C9D1D9"]],annotations:[],themeName:"github-dark",style:{color:"#c9d1d9",background:"#0d1117",colorScheme:"dark"}}}),"\n",(0,s.jsx)(r.h2,{id:n[9].id,children:n[9].value}),"\n",(0,s.jsxs)(r.p,{children:["The secret syntax works in all ",(0,s.jsx)(r.code,{children:"env"})," blocks:"]}),"\n",(0,s.jsx)(r.h3,{id:n[10].id,children:n[10].value}),"\n",(0,s.jsx)(t,{codeblock:{value:'services:\n  - name: my-service\n    github:\n      docker:\n        app:\n          env:\n            SECRET_KEY: "{{aws:path:key}}"\n        init:\n          env:\n            INIT_SECRET: "{{aws:path:key}}"',lang:"yaml",meta:"",code:'services:\n  - name: my-service\n    github:\n      docker:\n        app:\n          env:\n            SECRET_KEY: "{{aws:path:key}}"\n        init:\n          env:\n            INIT_SECRET: "{{aws:path:key}}"',tokens:[["services","#7EE787"],[":","#C9D1D9"],"\n  ",["-","#C9D1D9"]," ",["name","#7EE787"],[":","#C9D1D9"]," ",["my-service","#A5D6FF"],"\n    ",["github","#7EE787"],[":","#C9D1D9"],"\n      ",["docker","#7EE787"],[":","#C9D1D9"],"\n        ",["app","#7EE787"],[":","#C9D1D9"],"\n          ",["env","#7EE787"],[":","#C9D1D9"],"\n            ",["SECRET_KEY","#7EE787"],[":","#C9D1D9"]," ",['"{{aws:path:key}}"',"#A5D6FF"],"\n        ",["init","#7EE787"],[":","#C9D1D9"],"\n          ",["env","#7EE787"],[":","#C9D1D9"],"\n            ",["INIT_SECRET","#7EE787"],[":","#C9D1D9"]," ",['"{{aws:path:key}}"',"#A5D6FF"]],annotations:[],themeName:"github-dark",style:{color:"#c9d1d9",background:"#0d1117",colorScheme:"dark"}}}),"\n",(0,s.jsx)(r.h3,{id:n[11].id,children:n[11].value}),"\n",(0,s.jsx)(t,{codeblock:{value:'services:\n  - name: my-service\n    docker:\n      dockerImage: myorg/image\n      defaultTag: latest\n      env:\n        SECRET_KEY: "{{aws:path:key}}"',lang:"yaml",meta:"",code:'services:\n  - name: my-service\n    docker:\n      dockerImage: myorg/image\n      defaultTag: latest\n      env:\n        SECRET_KEY: "{{aws:path:key}}"',tokens:[["services","#7EE787"],[":","#C9D1D9"],"\n  ",["-","#C9D1D9"]," ",["name","#7EE787"],[":","#C9D1D9"]," ",["my-service","#A5D6FF"],"\n    ",["docker","#7EE787"],[":","#C9D1D9"],"\n      ",["dockerImage","#7EE787"],[":","#C9D1D9"]," ",["myorg/image","#A5D6FF"],"\n      ",["defaultTag","#7EE787"],[":","#C9D1D9"]," ",["latest","#A5D6FF"],"\n      ",["env","#7EE787"],[":","#C9D1D9"],"\n        ",["SECRET_KEY","#7EE787"],[":","#C9D1D9"]," ",['"{{aws:path:key}}"',"#A5D6FF"]],annotations:[],themeName:"github-dark",style:{color:"#c9d1d9",background:"#0d1117",colorScheme:"dark"}}}),"\n",(0,s.jsx)(r.h3,{id:n[12].id,children:n[12].value}),"\n",(0,s.jsx)(t,{codeblock:{value:'environment:\n  webhooks:\n    - name: run-migrations\n      state: deployed\n      type: docker\n      docker:\n        image: myorg/migrator:latest\n      env:\n        DB_ADMIN_PASSWORD: "{{aws:myapp/rds-credentials:admin_password}}"',lang:"yaml",meta:"",code:'environment:\n  webhooks:\n    - name: run-migrations\n      state: deployed\n      type: docker\n      docker:\n        image: myorg/migrator:latest\n      env:\n        DB_ADMIN_PASSWORD: "{{aws:myapp/rds-credentials:admin_password}}"',tokens:[["environment","#7EE787"],[":","#C9D1D9"],"\n  ",["webhooks","#7EE787"],[":","#C9D1D9"],"\n    ",["-","#C9D1D9"]," ",["name","#7EE787"],[":","#C9D1D9"]," ",["run-migrations","#A5D6FF"],"\n      ",["state","#7EE787"],[":","#C9D1D9"]," ",["deployed","#A5D6FF"],"\n      ",["type","#7EE787"],[":","#C9D1D9"]," ",["docker","#A5D6FF"],"\n      ",["docker","#7EE787"],[":","#C9D1D9"],"\n        ",["image","#7EE787"],[":","#C9D1D9"]," ",["myorg/migrator:latest","#A5D6FF"],"\n      ",["env","#7EE787"],[":","#C9D1D9"],"\n        ",["DB_ADMIN_PASSWORD","#7EE787"],[":","#C9D1D9"]," ",['"{{aws:myapp/rds-credentials:admin_password}}"',"#A5D6FF"]],annotations:[],themeName:"github-dark",style:{color:"#c9d1d9",background:"#0d1117",colorScheme:"dark"}}}),"\n",(0,s.jsx)(i.P,{type:"warning",children:(0,s.jsx)(r.p,{children:"Helm and Codefresh deployment types do not currently support cloud secrets."})}),"\n",(0,s.jsx)(r.h2,{id:n[13].id,children:n[13].value}),"\n",(0,s.jsxs)(r.p,{children:["You can combine cloud secrets with regular template variables in the same ",(0,s.jsx)(r.code,{children:"env"})," block:"]}),"\n",(0,s.jsx)(t,{codeblock:{value:'env:\n  # Cloud secret\n  DB_PASSWORD: "{{aws:myapp/rds-credentials:password}}"\n\n  # Template variable (service reference)\n  BACKEND_URL: "{{{backend_publicUrl}}}"\n\n  # Static value\n  APP_ENV: "ephemeral"\n\n  # Build context\n  BUILD_UUID: "{{{buildUUID}}}"',lang:"yaml",meta:"",code:'env:\n  # Cloud secret\n  DB_PASSWORD: "{{aws:myapp/rds-credentials:password}}"\n\n  # Template variable (service reference)\n  BACKEND_URL: "{{{backend_publicUrl}}}"\n\n  # Static value\n  APP_ENV: "ephemeral"\n\n  # Build context\n  BUILD_UUID: "{{{buildUUID}}}"',tokens:[["env","#7EE787"],[":","#C9D1D9"],"\n  ",["# Cloud secret","#8B949E"],"\n  ",["DB_PASSWORD","#7EE787"],[":","#C9D1D9"]," ",['"{{aws:myapp/rds-credentials:password}}"',"#A5D6FF"],"\n\n  ",["# Template variable (service reference)","#8B949E"],"\n  ",["BACKEND_URL","#7EE787"],[":","#C9D1D9"]," ",['"{{{backend_publicUrl}}}"',"#A5D6FF"],"\n\n  ",["# Static value","#8B949E"],"\n  ",["APP_ENV","#7EE787"],[":","#C9D1D9"]," ",['"ephemeral"',"#A5D6FF"],"\n\n  ",["# Build context","#8B949E"],"\n  ",["BUILD_UUID","#7EE787"],[":","#C9D1D9"]," ",['"{{{buildUUID}}}"',"#A5D6FF"]],annotations:[],themeName:"github-dark",style:{color:"#c9d1d9",background:"#0d1117",colorScheme:"dark"}}}),"\n",(0,s.jsx)(r.h2,{id:n[14].id,children:n[14].value}),"\n",(0,s.jsx)(r.p,{children:"Both providers are enabled by default. If your platform team has configured ClusterSecretStores for both AWS and GCP, you can reference secrets from either in the same deployment:"}),"\n",(0,s.jsx)(t,{codeblock:{value:'env:\n  AWS_SECRET: "{{aws:myapp/aws-config:key}}"\n  GCP_SECRET: "{{gcp:my-project/gcp-config:key}}"',lang:"yaml",meta:"",code:'env:\n  AWS_SECRET: "{{aws:myapp/aws-config:key}}"\n  GCP_SECRET: "{{gcp:my-project/gcp-config:key}}"',tokens:[["env","#7EE787"],[":","#C9D1D9"],"\n  ",["AWS_SECRET","#7EE787"],[":","#C9D1D9"]," ",['"{{aws:myapp/aws-config:key}}"',"#A5D6FF"],"\n  ",["GCP_SECRET","#7EE787"],[":","#C9D1D9"]," ",['"{{gcp:my-project/gcp-config:key}}"',"#A5D6FF"]],annotations:[],themeName:"github-dark",style:{color:"#c9d1d9",background:"#0d1117",colorScheme:"dark"}}}),"\n",(0,s.jsx)(i.P,{type:"info",children:(0,s.jsx)(r.p,{children:"Each provider requires its own ClusterSecretStore. Contact your platform team\nif you need multi-cloud secret access."})}),"\n",(0,s.jsx)(r.h2,{id:n[15].id,children:n[15].value}),"\n",(0,s.jsx)(r.p,{children:"Lifecycle uses a “warn and continue” approach for secret errors:"}),"\n",(0,s.jsxs)(r.table,{children:[(0,s.jsx)(r.thead,{children:(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.th,{children:"Scenario"}),(0,s.jsx)(r.th,{children:"Behavior"})]})}),(0,s.jsxs)(r.tbody,{children:[(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"Secret not found"}),(0,s.jsx)(r.td,{children:"Warning logged, env var not set, deployment continues"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"Key not found in JSON"}),(0,s.jsx)(r.td,{children:"Warning logged, env var not set"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"Provider not enabled"}),(0,s.jsx)(r.td,{children:"Warning logged, env var not set"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"Invalid syntax"}),(0,s.jsx)(r.td,{children:"Validation error at deploy time"})]})]})]}),"\n",(0,s.jsx)(i.P,{type:"warning",children:(0,s.jsx)(r.p,{children:"If a required secret is missing, your application may fail to start or behave\nunexpectedly. Always verify your secrets exist before deploying."})}),"\n",(0,s.jsx)(r.h2,{id:n[16].id,children:n[16].value}),"\n",(0,s.jsx)(r.h3,{id:n[17].id,children:n[17].value}),"\n",(0,s.jsx)(r.p,{children:"Organize secrets with meaningful paths:"}),"\n",(0,s.jsx)(t,{codeblock:{value:'# Good\nDB_PASSWORD: "{{aws:myorg/api-server/production/database:password}}"\n\n# Less clear\nDB_PASSWORD: "{{aws:db-creds:password}}"',lang:"yaml",meta:"",code:'# Good\nDB_PASSWORD: "{{aws:myorg/api-server/production/database:password}}"\n\n# Less clear\nDB_PASSWORD: "{{aws:db-creds:password}}"',tokens:[["# Good","#8B949E"],"\n",["DB_PASSWORD","#7EE787"],[":","#C9D1D9"]," ",['"{{aws:myorg/api-server/production/database:password}}"',"#A5D6FF"],"\n\n",["# Less clear","#8B949E"],"\n",["DB_PASSWORD","#7EE787"],[":","#C9D1D9"]," ",['"{{aws:db-creds:password}}"',"#A5D6FF"]],annotations:[],themeName:"github-dark",style:{color:"#c9d1d9",background:"#0d1117",colorScheme:"dark"}}}),"\n",(0,s.jsx)(r.h3,{id:n[18].id,children:n[18].value}),"\n",(0,s.jsx)(r.p,{children:"Store related credentials in a single JSON secret:"}),"\n",(0,s.jsx)(t,{codeblock:{value:'// myapp/database-credentials\n{\n  "host": "db.example.com",\n  "port": "5432",\n  "username": "app_user",\n  "password": "secret123",\n  "database": "myapp"\n}',lang:"json",meta:"",code:'// myapp/database-credentials\n{\n  "host": "db.example.com",\n  "port": "5432",\n  "username": "app_user",\n  "password": "secret123",\n  "database": "myapp"\n}',tokens:[["// myapp/database-credentials","#8B949E"],"\n",["{","#C9D1D9"],"\n  ",['"host"',"#7EE787"],[":","#C9D1D9"]," ",['"db.example.com"',"#A5D6FF"],[",","#C9D1D9"],"\n  ",['"port"',"#7EE787"],[":","#C9D1D9"]," ",['"5432"',"#A5D6FF"],[",","#C9D1D9"],"\n  ",['"username"',"#7EE787"],[":","#C9D1D9"]," ",['"app_user"',"#A5D6FF"],[",","#C9D1D9"],"\n  ",['"password"',"#7EE787"],[":","#C9D1D9"]," ",['"secret123"',"#A5D6FF"],[",","#C9D1D9"],"\n  ",['"database"',"#7EE787"],[":","#C9D1D9"]," ",['"myapp"',"#A5D6FF"],"\n",["}","#C9D1D9"]],annotations:[],themeName:"github-dark",style:{color:"#c9d1d9",background:"#0d1117",colorScheme:"dark"}}}),"\n",(0,s.jsx)(r.p,{children:"Then reference individual keys:"}),"\n",(0,s.jsx)(t,{codeblock:{value:'env:\n  DB_HOST: "{{aws:myapp/database-credentials:host}}"\n  DB_PORT: "{{aws:myapp/database-credentials:port}}"\n  DB_USER: "{{aws:myapp/database-credentials:username}}"\n  DB_PASS: "{{aws:myapp/database-credentials:password}}"\n  DB_NAME: "{{aws:myapp/database-credentials:database}}"',lang:"yaml",meta:"",code:'env:\n  DB_HOST: "{{aws:myapp/database-credentials:host}}"\n  DB_PORT: "{{aws:myapp/database-credentials:port}}"\n  DB_USER: "{{aws:myapp/database-credentials:username}}"\n  DB_PASS: "{{aws:myapp/database-credentials:password}}"\n  DB_NAME: "{{aws:myapp/database-credentials:database}}"',tokens:[["env","#7EE787"],[":","#C9D1D9"],"\n  ",["DB_HOST","#7EE787"],[":","#C9D1D9"]," ",['"{{aws:myapp/database-credentials:host}}"',"#A5D6FF"],"\n  ",["DB_PORT","#7EE787"],[":","#C9D1D9"]," ",['"{{aws:myapp/database-credentials:port}}"',"#A5D6FF"],"\n  ",["DB_USER","#7EE787"],[":","#C9D1D9"]," ",['"{{aws:myapp/database-credentials:username}}"',"#A5D6FF"],"\n  ",["DB_PASS","#7EE787"],[":","#C9D1D9"]," ",['"{{aws:myapp/database-credentials:password}}"',"#A5D6FF"],"\n  ",["DB_NAME","#7EE787"],[":","#C9D1D9"]," ",['"{{aws:myapp/database-credentials:database}}"',"#A5D6FF"]],annotations:[],themeName:"github-dark",style:{color:"#c9d1d9",background:"#0d1117",colorScheme:"dark"}}}),"\n",(0,s.jsx)(r.h3,{id:n[19].id,children:n[19].value}),"\n",(0,s.jsx)(r.p,{children:"Be cautious when using secrets in build-time environment variables, as they may appear in build logs. Prefer injecting secrets at runtime when possible."}),"\n",(0,s.jsx)(r.h2,{id:n[20].id,children:n[20].value}),"\n",(0,s.jsx)(r.h3,{id:n[21].id,children:n[21].value}),"\n",(0,s.jsxs)(r.ol,{children:["\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.strong,{children:"Check the secret exists"})," in AWS Secrets Manager / GCP Secret Manager"]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.strong,{children:"Verify the path"})," matches exactly (case-sensitive)"]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.strong,{children:"Check the key name"})," if using JSON secrets"]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.strong,{children:"Review Lifecycle logs"})," for warnings about missing secrets"]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.strong,{children:"Verify provider is enabled"})," in global configuration"]}),"\n"]}),"\n",(0,s.jsx)(r.h3,{id:n[22].id,children:n[22].value}),"\n",(0,s.jsx)(r.p,{children:"Common syntax mistakes:"}),"\n",(0,s.jsx)(t,{codeblock:{value:'# Wrong - spaces in pattern\nDB_PASSWORD: "{{ aws:path:key }}"\n\n# Wrong - trailing colon\nDB_PASSWORD: "{{aws:path:}}"\n\n# Wrong - missing provider\nDB_PASSWORD: "{{path:key}}"\n\n# Correct\nDB_PASSWORD: "{{aws:path:key}}"',lang:"yaml",meta:"",code:'# Wrong - spaces in pattern\nDB_PASSWORD: "{{ aws:path:key }}"\n\n# Wrong - trailing colon\nDB_PASSWORD: "{{aws:path:}}"\n\n# Wrong - missing provider\nDB_PASSWORD: "{{path:key}}"\n\n# Correct\nDB_PASSWORD: "{{aws:path:key}}"',tokens:[["# Wrong - spaces in pattern","#8B949E"],"\n",["DB_PASSWORD","#7EE787"],[":","#C9D1D9"]," ",['"{{ aws:path:key }}"',"#A5D6FF"],"\n\n",["# Wrong - trailing colon","#8B949E"],"\n",["DB_PASSWORD","#7EE787"],[":","#C9D1D9"]," ",['"{{aws:path:}}"',"#A5D6FF"],"\n\n",["# Wrong - missing provider","#8B949E"],"\n",["DB_PASSWORD","#7EE787"],[":","#C9D1D9"]," ",['"{{path:key}}"',"#A5D6FF"],"\n\n",["# Correct","#8B949E"],"\n",["DB_PASSWORD","#7EE787"],[":","#C9D1D9"]," ",['"{{aws:path:key}}"',"#A5D6FF"]],annotations:[],themeName:"github-dark",style:{color:"#c9d1d9",background:"#0d1117",colorScheme:"dark"}}}),"\n",(0,s.jsx)(r.h3,{id:n[23].id,children:n[23].value}),"\n",(0,s.jsx)(r.p,{children:"If you see permission errors:"}),"\n",(0,s.jsxs)(r.ol,{children:["\n",(0,s.jsx)(r.li,{children:"Verify the External Secrets Operator has access to the secret path"}),"\n",(0,s.jsx)(r.li,{children:"Check IAM policies allow access to the specific secret"}),"\n",(0,s.jsx)(r.li,{children:"Contact your platform team if the secret is in a restricted path"}),"\n"]}),"\n",(0,s.jsx)(r.h3,{id:n[24].id,children:n[24].value}),"\n",(0,s.jsxs)(r.p,{children:["If you use ",(0,s.jsx)(r.code,{children:"{{gcp:...}}"})," on an AWS cluster (or vice versa), the ExternalSecret will fail to sync because the ClusterSecretStore doesn’t exist. Check Lifecycle logs for warnings like “ClusterSecretStore not found”."]}),"\n",(0,s.jsx)(r.h2,{id:n[25].id,children:n[25].value}),"\n",(0,s.jsx)(r.p,{children:"For cloud secrets to work, your platform team must set up:"}),"\n",(0,s.jsxs)(r.table,{children:[(0,s.jsx)(r.thead,{children:(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.th,{children:"Component"}),(0,s.jsx)(r.th,{children:"Description"})]})}),(0,s.jsxs)(r.tbody,{children:[(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.strong,{children:"External Secrets Operator"})}),(0,s.jsx)(r.td,{children:"Kubernetes operator that syncs secrets from cloud providers"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.strong,{children:"ClusterSecretStore"})}),(0,s.jsx)(r.td,{children:"CR that configures ESO to connect to AWS Secrets Manager or GCP Secret Manager"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.strong,{children:"IAM/Workload Identity"})}),(0,s.jsx)(r.td,{children:"Permissions for ESO to read secrets (IRSA for AWS, Workload Identity for GCP)"})]})]})]}),"\n",(0,s.jsxs)(r.p,{children:["The ",(0,s.jsx)(r.code,{children:"clusterSecretStore"})," value in your Lifecycle config must match the ClusterSecretStore name configured by your platform team."]}),"\n",(0,s.jsx)(r.h2,{id:n[26].id,children:n[26].value}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.a,{href:"/docs/features/template-variables",children:"Template Variables"})," - Learn about other template syntax"]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.a,{href:"/docs/features/webhooks",children:"Webhooks"})," - Using secrets in webhook environment variables"]}),"\n"]})]})},"/docs/features/secrets",{filePath:"src/pages/docs/features/secrets.mdx",timestamp:1769462625e3,pageMap:a.O,frontMatter:{title:"Cloud Secrets",tags:["secrets","aws","gcp","environment variables","security"]},title:"Cloud Secrets"},"undefined"==typeof RemoteContent?c:RemoteContent.useTOC)}},e=>{var n=n=>e(e.s=n);e.O(0,[1781,636,6593,8792],()=>n(16064)),_N_E=e.O()}]);